<div data-controller="search">
  <p id="notice"><%= notice %></p>

  <div class="shop-header">
    <div class="space">
      <h1>Products</h1>
    </div>
    <div class="text-center space">
      <%= form_with url: root_path, method: :get, html: { class:'my-4', data: { search_target: 'form' }} do |f| %>
          <%= f.text_field :query, class: "form-control text-center search", placeholder: 'Search by name or code', value: params[:query], 
                            data: { action: 'keyup->search#update', search_target: 'query' } %>
      <% end %>
    </div>  
    <div class="space d-flex justify-content-end" id="cart">
      <%= render 'carts/cart' %>
    </div>
  </div>

    <div data-search-target="output">
      <table class="table">
        <thead>
          <tr>
            <th>Name</th>
            <th>Price</th>
            <th colspan="3"></th>
          </tr>
        </thead>

        <tbody>
          <% @products.order('name').each do |product| %>
            <tr>
            <td></td>
              <td><%= link_to product.name, product_path(product), class:'text-decoration-none', style:'color: black' %></td>
            
              <td><%= number_to_currency product.price, :unit => :â‚¬ %></td>
              <td><%= link_to 'Details', product_path(product, query: params[:query] ), class: "text-decoration-none" %></td>

              <td>
                <%= form_for @order_item, remote: true do |f|%>
                <%= f.hidden_field :product_id, :value => product.id %>
                <%= f.number_field :quantity, :value => 1, :min => 1, class: "text-center" %>
                <%= f.submit 'Add to cart', class: "add_to_cart" %>
                <% end %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    <br>
    </div>
</div>